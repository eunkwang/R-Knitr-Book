
## 3.1------------------------------------------------------------------------
1
"korea"
"1"


1+2
(3+4)/5
2^(1/2)


3 > 5
5 >3
4 == 4
4 !=3


(3 >5) && (5>3)
(3>1) || (5>3) 
(1!=0) || ( 2 >1)


a <- 1:10
a[a>5 & a<8]


a


a <- 123


a


b <- 356


## 3.2.------------------------------------------------------------------------
a <- c(1, 3, "ab", "b")
a


## 3.2.1------------------------------------------------------------------------
height <- c(134, 145, 139, 140, 141)
is.vector(height)


a <- 1:5
a
b <- seq(20, 5, by = -2)
b
bb <- seq(20, 5, length=7)
bb
c <- rep(c("M", "F"), c(3, 2))
c


height
length(height)
height[1]
height[5]
height[c(1,2,5)]


vec <- c(5,6,7,8,9)
sqrt(vec)
paste0("file", vec)
sqrt(vec[c(1,2,5)])


a <- c(-1, 1, 1)
b <- c(1,2,3,4,5,6)
a
b
a+b


## 3.2.2------------------------------------------------------------------------
b <- c(1,2,3,4,5,6)
b[b>3]
b[c(1,2,4)]
b[-c(1,3,4)]
b[]



names(b) <- LETTERS[1:6]
b


b[c("A", "C")]


b <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
i <- c(1,2,3)
b[i^2]


## 3.2.3------------------------------------------------------------------------
b <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
b[c(4,5,7)]
b[c(4,5,7)] <- c(44, 55, 77)
b
b[b>9]<-c(99,99, 99, 99)
b


b<-b[-10]
b


bb<-1:10
bb <- bb[-length(bb)]
bb


## 3.2.4------------------------------------------------------------------------
a <- c(3, 5, 1, 6)
sort(a)
sort(a, decreasing=TRUE)


order(a)
a[order(a)]
a[order(a, decreasing=TRUE)]


## 3.2.5------------------------------------------------------------------------
a <- c(135, 140, 145, 136, 135)
b <- c("A", "B", "A", "B", "C")
df <-data.frame(a, b)
class(df)
df


df1 <- data.frame(NameA=a, NameB=b)
df1


length(df)


## ------------------------------------------------------------------------
dim(df)
ncol(df)
nrow(df)


## ------------------------------------------------------------------------
names(df)
row.names(df)


## ------------------------------------------------------------------------
str(df)


## ------------------------------------------------------------------------
attributes(df)


## ------------------------------------------------------------------------
names(df)[2] <- "bb"
df


## ------------------------------------------------------------------------
df
df[2, 1]


## ------------------------------------------------------------------------
df[2,1] <- 21
df


## ----eval=FALSE----------------------------------------------------------
## df[2:5, ]


## ------------------------------------------------------------------------
df[2:5, ]
df


## ----eval=FALSE----------------------------------------------------------
## df[, -2]


## ------------------------------------------------------------------------
df[,-2]


## ------------------------------------------------------------------------
df[, 1]


## ------------------------------------------------------------------------
names(df)


## ------------------------------------------------------------------------
df['bb']


## ------------------------------------------------------------------------
df$bb


## ------------------------------------------------------------------------
x <- 'bb'
df$x


## ------------------------------------------------------------------------
x <- 'bb'
df[, x]


## ------------------------------------------------------------------------
x <- 'bb'
df[, x, drop=FALSE] 


## ------------------------------------------------------------------------
df
cc<- 11:15
df1 <- cbind(df, cc)
df1
df$cc <- cc
df


## ------------------------------------------------------------------------
df <- df[,-2]
df


## ------------------------------------------------------------------------
df$a <-NULL
df


## ------------------------------------------------------------------------
a <- c(3,5, 2, 1, 6)
b <- letters[1:5]
c <- 15:11
df <- data.frame(a,b,c)
df
df[order(c),]
df[order(a, decreasing=TRUE),]


## 3.2.6------------------------------------------------------------------------
fac1 <- factor(c("M", "F", "F","M"))
fac2 <- factor(c(1,2,1,1,2,3))
fac1
fac2


## ------------------------------------------------------------------------
attributes(fac1)


## ------------------------------------------------------------------------
levels(fac1)


## ----eval=FALSE----------------------------------------------------------
## sample(x, size, replace = FALSE)


## ----size='footnotesize'-------------------------------------------------
set.seed(1)
fac3 <- factor(sample(c("high", "middle", "low"), 20, replace=TRUE))
fac3
levels(fac3)


## ------------------------------------------------------------------------
table(fac3)


## ----out.width='0.6\\textwidth', fig.align='center'----------------------
barplot(table(fac3))


## ----tidy=FALSE----------------------------------------------------------
fac3
fac4 <- factor(fac3, levels=c("low", "middle", "high"), 
               ordered=TRUE)


## ----out.width='0.6\\textwidth', fig.align='center'----------------------
table(fac4)
barplot(table(fac4))


## ------------------------------------------------------------------------
fac5 <- factor(sample(c(1,0), 20, replace=T))
fac5
table(fac5)


## ------------------------------------------------------------------------
levels(fac5)
fac6 <- factor(fac5, labels=c("abs", "pre"))
fac6


## ------------------------------------------------------------------------
ran <-sample(1:100, 50, replace=FALSE)


## ----size='scriptsize'---------------------------------------------------
cut(ran, breaks=10)
cut(ran, breaks=c(-1,20, 30, 70, 101))


## ------------------------------------------------------------------------
table(cut(ran, breaks=c(-1, 20, 30, 70, 101)))


## ----out.width='0.6\\textwidth', fig.align='center', tidy=FALSE----------
ran1 <-cut(ran, breaks=c(-1,20,30, 70, 101),
          labels=c("Int1", "Int2", "Int3","Int4"))
table(ran1)
barplot(table(ran1))


## 3.2.7------------------------------------------------------------------
## rep(x, times)


## ----tidy=FALSE----------------------------------------------------------
treat <- c(rep("yes", 90), rep("no", 100))
treat <- factor(treat, levels=c("yes", "no"), 
                ordered=TRUE)
disease <- c(rep("occur", 10), rep("none",80), 
             rep("occur", 40), rep("none", 60) )
disease <- factor(disease, levels=c("occur", "none"), 
                  ordered=TRUE)
df <- data.frame(treat, disease)
head(df)


## ------------------------------------------------------------------------
tb <-table(df$treat, df$disease)
tb
class(tb)


## ------------------------------------------------------------------------
prop.table(tb)


## ------------------------------------------------------------------------
addmargins(tb)


## ------------------------------------------------------------------------
addmargins(tb, 1)
addmargins(tb, 2)


## ------------------------------------------------------------------------
pp <- addmargins(tb) * 100 /sum(tb)
pp <- round(pp,1)
pp


## ----out.width="0.6\\textwidth"------------------------------------------
barplot(t(tb), legend.text=colnames(tb))


## ----size='footnotesize'-------------------------------------------------
test1 <-chisq.test(tb)
test1
test2 <- fisher.test(tb)
test2


## ------------------------------------------------------------------------
attributes(test1)


## ------------------------------------------------------------------------
test1$p.value


## ------------------------------------------------------------------------
test1$expected


## 3.2.8------------------------------------------------------------------------
a <- c(NA, 2, 3, 5)


## ------------------------------------------------------------------------
is.na(a)


## ------------------------------------------------------------------------
a <- a[!is.na(a)]
a


## ------------------------------------------------------------------------
df <- data.frame(aa=c(NA, 4, 5, 6, 6), bb=letters[1:5])
df<- na.omit(df)
df


## ------------------------------------------------------------------------
a <- c(999, 1,3, 5, 8)
a[a==999]<-NA
a


## 3.2.9------------------------------------------------------------------------
dates <- c("2013/01/05", "2012/12/24", "2011/11/25")
dates
class(dates)
dd <- as.Date(dates)
class(dd)


dd[1]-dd[3]


date2 <- c("2010-09-30", "2009-01-15")
dd2 <- as.Date(date2)
dd2
class(dd2)


## as.Date("2013년 12월 5일")


as.Date("2013년 12월 5일", format="%Y년 %m월 %d일")


as.Date("760314", format="%y%m%d")


as.Date(34519,origin="1900-01-01")


as.POSIXct("2012-09-16 09:03:34")


library(lubridate)


ymd("2012-10-12")
ymd("20121012")
ymd("121012")
dmy("12-10-2012")
ymd("2012년 10월 12일")
dmy("12일10월2012년")


x <- c(20090101, "2009-01-02", "2009 01 03", 
"2009-1-4","2009-1, 5", "Created on 2009 1 6")
ymd(x)


tree <- ymd("2013-04-05")
year(tree)
month(tree)
month(tree, label=TRUE)
week(tree)
yday(tree)
mday(tree)
wday(tree)
wday(tree, label=TRUE)


months(tree)
months(tree, abb=TRUE)
weekdays(tree)
weekdays(tree, abb=TRUE)
quarter(tree)
julian(tree)


customers <-c("cust1", "cust2")
checkin <- ymd(c("2013-01-10", "2013-01-13"))
checkout <- ymd(c("2013-02-19", "2013-03-21"))
hotel <- data.frame(customers, checkin, checkout)
hotel
str(hotel)
is.instant(hotel$checkin)
is.instant(hotel$checkout)


hotel$stay1 <- interval(hotel$checkin, hotel$checkout)
hotel$stay2 <- hotel$checkin %--% hotel$checkout
class(hotel$stay1)
class(hotel$stay2)
hotel


int_start(hotel$stay1)
int_end(hotel$stay2)


intersect(hotel$stay1[1], hotel$stay1[2])
int_overlaps(hotel$stay1[1], hotel$stay1[2])


as.duration(hotel$stay1)


hotel$stay1/ddays(1)


hotel$stay1/dweeks(1)
hotel$stay1/dyears(1)


leap_year(2012)
leap_year(2013)


ymd("2012-01-01")+dyears(1)
ymd("2013-01-01")+dyears(1)


as.period(hotel$stay1)


ymd("2012-01-01")+dyears(1)
ymd("2013-01-01")+dyears(1)
ymd("2012-01-01")+years(1)
ymd("2013-01-01")+years(1)


ymd("2012-01-31")+months(1)


ymd("2012-01-31") %m+% months(1) #한달 후
ymd("2012-01-31") %m-% months(1) #한달 전


