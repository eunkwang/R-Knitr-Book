## 워드에서 읽을 수 있는 파일로 바꾸기 ###

이 책에서 소개하는 R과 R markdown을 혼용하여 사용하는 경우 다음 과정을 거쳐 문서가 완성된다.

1. 1차 컴파일: R 코드청크가 실행되는 것으로, .Rmd 파일이 .md 파일로 변환된다.
2. 2차 컴파일: 마크다운 마크업이 HTML 마크업으로 변환되며, .md 파일이 .html로 변환된다.

여기서 원 파일인 .Rmd 파일과 중간 파일인 .md 파일을 활용하여 필요한 경우  다른 포맷의 문서로 쉽게 바꿀 수 있다. 이 경우 큰 도움이 되는 도구가 [pandoc](http://johnmacfarlane.net/pandoc/)이다. 사이트를 보면 윈도우즈, 맥 등 시스템에 맞게 설치할 수 있는 링크가 있다. 이것을 컴퓨터에 설치한다. 

이렇게 pandoc가 설치되었다면 knitr 패키지에서 `pandoc()` 함수를 사용할 수 있게 된다. 물론 pandoc 자체를 사용할 수도 있다. 하지만 pandoc이 커맨드라인툴이고 옵션 등이 많아서 익히기가 쉽지 않은데, knitr 패키지의 `pandoc()` 함수를 사용하면 이 기능을 그대로 끌고 와서 사용할 수 있다. 

현재 이 파일(chapter9ToWord.Rmd)이 RStudio의 워킹디렉터리에서 읽었다고 가정한다. 먼저 R 콘솔에서 니터 패키지를 로딩한다. 


```r
library(knitr)
```

knitr 패키지의 도움말을 확인한다. 


```r
help(pandoc)
```


도움말을 보면 `format`이라는 옵션이 있는데, 여기에 출력할 파일의 포맷의 확장자를 적어준다. 예를 들어 워드에서 읽을 수 있게 하기 위해서는 `format='docx'`라고 한다. 


```r
pandoc("chapter9ToWord.md", format = "docx")
```


니터 패키지의 `pandoc()` 함수의 경우 원래의 .Rmd 파일로 명령을 줄 수 있으나, 그래프나 표 등을 제대로 전환하기 위해서는 중간 단계의 .md 파일을 사용하는 것이 좋다. 워낙에 pandoc이라는 도구 자체가 마크다운 포맷을 기본으로 사용하기 때문이다. 

니터 패키지를 사용하지 않고, 직접 pandoc을 사용하는 경우라면 커맨드라인에서 작업해야 한다.  아래에서 `-o` 플래그는 출력을 의미한다. 

```
$pandoc chapter9ToWord.md -o myDocx.docx
```

### 그래프 처리 ###


문서가 제대로 변환된다고 생각한다면 표와 그림도 넣어 보자. 



```r
hist(rnorm(1000))
```

![plot of chunk unnamed-chunk-4](figure/unnamed-chunk-4.png) 


이전에는 코드 청크 옵션을 넣으면 워드 파일로 변환이 잘 되지 않았는데, 개선이 된 듯하다. 

### 표의 처리 ###

책의 6장 5절에서 표를 만드는 방법을 설명했다. 여러 가지 방법을 시도해 보았는데, 믿을만하게 표를 정확히 워드 표로 변환하기는 쉽지 않았다. 시도는 해 보는 것은 좋다고 생각되지만 가급적인 이 부분은 직접 워드에서 작업하는 것이 좋을 듯 하다.   

### 또 다른 마크다운: 팬독 마크다운 ###

이 부분은 pandoc을 주로 사용할 필요가 있는 경우나 도전적인 독자들이라면 의미는 있겠으나, 일반적인 경우 의미가 없다고 판단되어 자세한 내용은 책을 참고했으면 한다.  


